"use strict";function pulldownRefresh(){setTimeout(function(){mui("#pullrefresh").pullRefresh().endPulldownToRefresh()},500)}function pullupRefresh(){setTimeout(function(){collocationLoad(collocationIndex),mui("#pullrefresh").pullRefresh().endPullupToRefresh(collocationIndex>4),++collocationIndex>4&&(collocationIndex=1)},500)}function init(){initLoad(),collocationLoad(1)}function initLoad(){mui.ajax(SERVER_URL+"/home/banner",{type:"get",success:function(t){if(!t.status.code)return void console.log(t.status.msg);for(var i=t.result.list,e=document.querySelector("#j-slider .mui-slider-group"),a=document.querySelector("#j-slider .mui-slider-indicator"),l="",s="",o=0;o<i.length;o++)0===o?(l+='<div class="mui-slider-item mui-slider-item-duplicate"><a class="web-template" data-title="'+i[i.length-1].title+'" data-link="'+i[i.length-1].link+'"><img src="'+i[i.length-1].image+'" alt="'+i[i.length-1].title+'"></a></div>',s+='<div class="mui-indicator mui-active"></div>'):s+='<div class="mui-indicator"></div>',l+='<div class="mui-slider-item"><a class="web-template" data-title="'+i[o].title+'" data-link="'+i[o].link+'"><img src="'+i[o].image+'" alt="'+i[o].title+'"></a></div>',o===i.length-1&&(l+='<div class="mui-slider-item mui-slider-item-duplicate"><a class="web-template" data-title="'+i[0].title+'" data-link="'+i[0].link+'"><img src="'+i[0].image+'" alt="'+i[0].title+'"></a></div>');e.innerHTML=l,a.innerHTML=s,mui("#j-banner").slider({interval:3500})},error:function(t){mui.toast("网络异常，连接失败")}}),mui.ajax(SERVER_URL+"/home/nav",{type:"get",success:function(t){if(!t.status.code)return void console.log(t.status.msg);var i=t.result.list,e=document.querySelector(".m-home-nav .mui-scroll"),a="",l=!0,s=!1,o=void 0;try{for(var n,d=i[Symbol.iterator]();!(l=(n=d.next()).done);l=!0){var r=n.value;a+='<a class="item tips" data-link="'+r.link+'" data-title="'+r.title+'"><img src="'+r.image+'" alt="'+r.title+'" /><div>'+r.title+"</div></a>"}}catch(t){s=!0,o=t}finally{try{!l&&d.return&&d.return()}finally{if(s)throw o}}e.innerHTML=a},error:function(t){mui.toast("网络异常，连接失败")}}),mui.ajax(SERVER_URL+"/home/act",{type:"get",success:function(t){if(!t.status.code)return void console.log(t.status.msg);var i=t.result,e=document.querySelector(".m-activity");if(i.cover&&i.cover.length>0){var a=!0,l=!1,s=void 0;try{for(var o,n=i.cover[Symbol.iterator]();!(a=(o=n.next()).done);a=!0){var d=o.value,r=document.createElement("div");r.className="activity",r.innerHTML='<a class="web-template" data-link="'+d.link+'" data-title="'+d.title+'"><img src="'+d.image+'" alt="'+d.title+'" /></a>',e.appendChild(r)}}catch(t){l=!0,s=t}finally{try{!a&&n.return&&n.return()}finally{if(l)throw s}}}if(i.list&&i.list.length>0){var c=document.createElement("div");c.className="activity-cate mui-clearfix";var u="",m=!0,p=!1,g=void 0;try{for(var v,f=i.list[Symbol.iterator]();!(m=(v=f.next()).done);m=!0){var L=v.value;u+='<a class="item" data-title="'+L.title+'" data-link="'+L.link+'"><img src="'+L.image+'" alt="'+L.title+'" /></a>'}}catch(t){p=!0,g=t}finally{try{!m&&f.return&&f.return()}finally{if(p)throw g}}c.innerHTML=u,e.appendChild(c)}},error:function(t){mui.toast("网络异常，连接失败")}}),mui.ajax(SERVER_URL+"/home/popular",{type:"get",success:function(t){if(!t.status.code)return void console.log(t.status.msg);for(var i=t.result.list,e=document.querySelector(".m-popular .mui-slider .mui-slider-group"),a=[],l=0;l<i.length;l+=2){var s=document.createElement("div");s.className="col",s.innerHTML='<a class="item tips" data-title="'+i[l].title+'" data-link="'+i[l].link+'"><img src="'+i[l].image+'" alt="'+i[l].title+'"/><span>'+i[l].title+"</span></a>",i[l+1]&&(s.innerHTML+='<a class="item tips" data-title="'+i[l+1].title+'" data-link="'+i[l+1].link+'"><img src="'+i[l+1].image+'" alt="'+i[l+1].title+'"/><span>'+i[l+1].title+"</span></a>"),a.push(s)}for(var o=a.length,n=o%4?parseInt(o/4)+1:parseInt(o/4),d=0,r=0;r<n;r++){var c=document.createElement("div");c.className="mui-slider-item";for(var u=0,m=4*d;m<a.length&&(c.appendChild(a[m]),4!=++u);m++);e.appendChild(c),d++}mui("#j-popular").slider()},error:function(t){mui.toast("网络异常，连接失败")}})}function collocationLoad(t){mui.ajax(SERVER_URL+"/home/collocation",{type:"get",data:{index:t},success:function(t){if(!t.status.code)return void console.log(t.status.msg);var i=t.result.list,e=document.querySelector(".m-collocation .collocation-wrap"),a=document.createElement("div");a.className="collocation-item",a.innerHTML='<!-- 块上半部 -->\n<div id="'+i[0].id+'" class="collocation-item-top mui-clearfix">\n\t<div class="mui-clearfix">\n\t\t<!-- 左侧大图 -->\n\t\t<div class="mui-col-xs-8 mui-pull-left">\n\t\t\t<a id="'+i[0].goodsList[0].id+'" class="web-template" data-title="'+i[0].title+'" data-link="'+i[0].goodsList[0].detailUrl+'">\n                <img src="'+i[0].goodsList[0].image+'" alt="'+i[0].description+'"/>\n            </a>\n\t\t</div>\n\t\t<!-- 右侧小图 -->\n\t\t<div class="mui-col-xs-4 mui-pull-left">\n\t\t\t<a id="'+i[0].goodsList[1].id+'" class="product-template" data-title="'+i[0].goodsList[1].title+'" data-link="'+i[0].goodsList[1].wapGoodUrl+'" >\n                <img src="'+i[0].goodsList[1].image+'" alt="'+i[0].goodsList[1].title+'"/>\n                <span>￥'+i[0].goodsList[1].price+'</span>\n\t\t\t</a>\n\t\t\t<a id="'+i[0].goodsList[2].id+'" class="product-template" data-title="'+i[0].goodsList[2].title+'" data-link="'+i[0].goodsList[2].wapGoodUrl+'" >\n                <img src="'+i[0].goodsList[2].image+'" alt="'+i[0].goodsList[2].title+'"/>\n                <span>￥'+i[0].goodsList[2].price+'</span>\n\t\t\t</a>\n\t\t\t<a id="'+i[0].goodsList[3].id+'" class="product-template" data-title="'+i[0].goodsList[3].title+'" data-link="'+i[0].goodsList[3].wapGoodUrl+'" >\n                <img src="'+i[0].goodsList[3].image+'" alt="'+i[0].goodsList[3].title+'"/>\n                <span>￥'+i[0].goodsList[3].price+'</span>\n\t\t\t</a>\n\t\t</div>\n\t</div>\n\t<!-- 简介 -->\n\t<div class="brief" data-deail="'+i[0].description+'">\n\t\t<h4>'+i[0].title+"</h4>\n\t\t<p>"+i[0].subTitle+'</p>\n\t</div>\n</div>\n<!-- /块上半部 -->\n<!-- 块下半部 -->\n<div id="'+i[1].id+'" class="collocation-item-bot">\n    <div class="banner">\n        <a class="web-template" data-title="'+i[1].title+'" data-link="'+i[1].originUrl+'">\n            <img src="'+i[1].image+'" alt="'+i[1].description+'"/>\n            <div class="overlay">\n                <h4>'+i[1].title+"</h4>\n                <p>"+i[1].subtitle+'</p>\n                <span>get 新品</span>\n            </div>\n        </a>\n    </div>\n    <div class="grid mui-clearfix">\n        <a id="'+i[1].goodsList[0].id+'" class="product-template" data-title="'+i[1].goodsList[0].title+'" data-link="'+i[1].goodsList[0].wapGoodUrl+'">\n            <img src="'+i[1].goodsList[0].image+'" alt="'+i[1].goodsList[0].title+'" />\n            <span>￥'+i[1].goodsList[0].price+'</span>\n        </a>\n        <a id="'+i[1].goodsList[1].id+'" class="product-template" data-title="'+i[1].goodsList[1].title+'" data-link="'+i[1].goodsList[1].wapGoodUrl+'">\n            <img src="'+i[1].goodsList[1].image+'" alt="'+i[1].goodsList[1].title+'" />\n            <span>￥'+i[1].goodsList[1].price+'</span>\n        </a>\n        <a id="'+i[1].goodsList[2].id+'" class="product-template" data-title="'+i[1].goodsList[2].title+'" data-link="'+i[1].goodsList[2].wapGoodUrl+'">\n            <img src="'+i[1].goodsList[2].image+'" alt="'+i[1].goodsList[2].title+'" />\n            <span>￥'+i[1].goodsList[2].price+'</span>\n        </a>\n        <a id="'+i[1].goodsList[3].id+'" class="product-template" data-title="'+i[1].goodsList[3].title+'" data-link="'+i[1].goodsList[3].wapGoodUrl+'">\n            <img src="'+i[1].goodsList[3].image+'" alt="'+i[1].goodsList[3].title+'" />\n            <span>￥'+i[1].goodsList[3].price+"</span>\n        </a>\n    </div>\n</div>",e.appendChild(a)},error:function(t){mui.toast("网络异常，连接失败")}})}mui.init({pullRefresh:{auto:!0,container:"#pullrefresh",down:{callback:pulldownRefresh},up:{contentrefresh:"正在加载...",callback:pullupRefresh}}}),mui.plusReady(function(){plus.webview.currentWebview().setStyle({render:"always"})});var collocationIndex=2;mui.os.plus?mui.plusReady(function(){setTimeout(function(){mui("#pullrefresh").pullRefresh().pulldownLoading()},100)}):mui.ready(function(){setTimeout(function(){mui("#pullrefresh").pullRefresh().pulldownLoading()},100)}),init(),mui("body").on("tap",".web-template",function(){var t={link:this.dataset.link,title:this.dataset.title};mui.openWindow("web-template.html","web-template",{extras:t})}).on("tap",".product-template",function(){var t={link:this.dataset.link};mui.openWindow("product-template.html","product-template",{extras:t})}).on("tap",".tips",function(){mui.toast("本App仅供学习使用\n如需参与活动请下载美丽说官方原版App")});